<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
        crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
        crossorigin="anonymous"></script>
    <title>Week 3 Code Challenge</title>
  </head>
  <body>
    <div class="conatiner">
      <center><button id="get-Users" class="btn btn-outline-primary">Submit</button></center>
      <center><button id="populate-Table" class="btn btn-outline-primary">Generate Table</button></center>
    </div>

    <script>
      let baseUrl = 'https://randomuser.me/api/'
      let urlNotFound = '';
      var email;
      var firstName;
      var lastName;
      var title;
      var phone;
      document.getElementById('populate-Table').addEventListener('click',generateTable);
      document.getElementById('get-Users').addEventListener('click',getRandomUser);
      function getRandomUser()
      {
        sendAjaxGet(baseUrl+ '?inc=name,phone,email',userInfo);
      }

      function sendAjaxGet(url, func)
      {
          xhr = (new XMLHttpRequest() || new ActiveXObject('Microsoft.HTTPRequest'));
          xhr.onreadystatechange = function () {
              if (this.status == 200 && this.readyState == 4) {
                  func(this);
              }
          }

          xhr.open('GET', url);
          xhr.send();
      }

      function userInfo(xhr)
      {
        let response = xhr.response;
        let parse = JSON.parse(response);
        let info = parse.results;
        for(i = 0; i<parse.length; i++)
        {
          email = info.results[i].email;
          firstName = info.results[i].name.first;
          lastName = info.results[i].name.last;
          title =info.results[i].name.title;
          phone = info.results[i].phone;
        }

      }

      function generateTable()
      {
        let info = userInfo();
        let table = document.createElement('table');
        let head = document.createElement('thead');
        let headRow = document.createElement('tr');
        let th1 = document.createElement('th');
        let th2 = document.createElement('th');
        let th3 = document.createElement('th');
        let th4 = document.createElement('th');
        let th5 = document.createElement('th');

        table.setAttribute('class', 'table table-striped table-bordered');
        head.setAttribute('class','thead-dark');
        th1.setAttribute('scope', 'col');
        th2.setAttribute('scope', 'col');
        th3.setAttribute('scope', 'col');
        th4.setAttribute('scope', 'col');
        th5.setAttribute('scope', 'col');

        table.appendChild(head);
        head.appendChild(headRow);
        head.appendChild(th1);
        head.appendChild(th2);
        head.appendChild(th3);
        head.appendChild(th4);
        head.appendChild(th5);

        th1.innerHTML = 'Title';
        th2.innerHTML = 'First';
        th3.innerHTML = 'Last';
        th4.innerHTML = 'Email';
        th5.innerHTML = 'phone';


        for(i =0; i<email.length; i++)
        {
          let row = document.createElement('tr');
          row.setAttribute('scope', 'row');

          for(j = 0; j < 5; j++)
          {
            let col = document.createElement('td');
            if(j == 0)
            {

              col.innerHTML = title[i];
            }
            if(j == 1)
            {
              col.innerHTML = firstName[i];
            }
            if(j == 2)
            {
              col.innerHTML = lastName[i];
            }
            if(j == 3)
            {
              col.innerHTML = email[i];
            }
            if(j == 4)
            {
              col.innerHTML = phone[i];
            }
            row.appendChild(col);
          }
          table.appendChild(row);

        }

        document.getElementById('table-div').appendChild(table);

      }

    </script>
    <div class='containter' id ="table-div">
    </div>
  </body>
</html>
